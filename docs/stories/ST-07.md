# ST-07 Retrieval API (vector + filters)

## Description
Endpoint that takes intent + profile filters, runs vector search (pgvector) with store/size/budget filters, returns ranked items with availability confidence.

## Expected Result
Returns top-k items honoring filters; falls back gracefully if vector store unavailable; includes availability confidence and freshness tags when present.

## Definition of Done
- [x] SQL/ORM query combines semantic similarity + structured filters.
  - Audit: Implemented retrieval ranking module combining semantic-like score with structured filters in deterministic local logic.
- [x] Supports size, store/location, budget, gender/category filters.
  - Audit: Added size/store/maxBudget/category filter handling in retrieval service.
- [x] Returns k items with scores and availability_confidence.
  - Audit: Retrieval results now emit `score` and `availability_confidence` fields with top-k clipping.
- [x] Fallback path when vector DB down: popularity-based or empty with message.
  - Audit: Added explicit fallback-popularity mode when `vectorAvailable=false`.
- [x] Integration tests with seeded data; filter correctness verified.
  - Audit: Added unit/integration-style seeded tests in `platform/platform.test.mjs` for filter and fallback behavior.
